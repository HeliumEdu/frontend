#!/usr/bin/env bash

if [[ "$npm_command" != "run-script" ]] && [[ "$npm_command" != "run" ]]; then
  echo "This script must be run within npm. Try \`npm build-dev\` or \`make build-dev\` instead."
  exit 1;
fi

set -e

PYTHON_BIN="${PYTHON_BIN:-python}"

if [[ "${USE_NGROK,,}" == "true" ]]; then
  $PYTHON_BIN -m pip install pyngrok
  ngrok start heliumedu --log stdout &
fi

make clean-assets
npm run build-dev
http-server ./build -p 3000 -a localhost -d false -c-1
